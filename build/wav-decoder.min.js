(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.WavDecoder=e()}})(function(){var e,t,r;return function n(e,t,r){function i(o,s){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!s&&a)return a(o,!0);if(f)return f(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=t[o]={exports:{}};e[o][0].call(h.exports,function(t){var r=e[o][1][t];return i(r?r:t)},h,h.exports,n,e,t,r)}return t[o].exports}var f=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e){return e&&e.__esModule?e:{"default":e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=e("inline-worker");var s=i(o);var a=e("./DecoderWorker");var u=i(a);var h=null;var l=function(){function e(){var t=this;f(this,e);this._worker=new s["default"](u["default"],u["default"].self);this._worker.onmessage=function(e){var r=e.data;var n=t._callbacks[r.callbackId];if(n){if(r.type==="decoded"){n.resolve({sampleRate:r.audioData.sampleRate,channelData:r.audioData.buffers.map(function(e){return new Float32Array(e)})})}else{n.reject(new Error(r.message))}}t._callbacks[r.callbackId]=null};this._callbacks=[]}n(e,[{key:"decode",value:function t(e){var t=this;return new Promise(function(r,n){var i=t._callbacks.length;t._callbacks.push({resolve:r,reject:n});if(e&&e.buffer instanceof ArrayBuffer){e=e.buffer}t._worker.postMessage({type:"decode",buffer:e,callbackId:i},[e])})}}],[{key:"decode",value:function r(t){if(h===null){h=new e}return h.decode(t)}}]);return e}();r["default"]=l;t.exports=r["default"]},{"./DecoderWorker":2,"inline-worker":6}],2:[function(e,t,r){var n=e("dataview2").DataView2;var self={};function i(){self.onmessage=function(e){if(e.data.type==="decode"){self.decode(e.data.callbackId,e.data.buffer)}};var e={1:"lpcm",3:"lpcm"};self.decode=function(e,t){function r(t){self.postMessage({type:"decoded",callbackId:e,audioData:t},[t.buffers])}function n(t){self.postMessage({type:"error",callbackId:e,message:t.message})}self.decodeWav(t).then(r,n)};self.decodeWav=function(e){return new Promise(function(r){var n=new t(e);if(n.readString(4)!=="RIFF"){throw new Error("Invalid WAV file")}n.readUint32();if(n.readString(4)!=="WAVE"){throw new Error("Invalid WAV file")}var i=null;var f=null;do{var o=n.readString(4);var s=n.readUint32();switch(o){case"fmt ":i=self.decodeFormat(n,s);break;case"data":f=self.decodeData(n,s,i);break;default:n.skip(s);break}}while(f===null);return r(f)})};self.decodeFormat=function(t,r){var n=t.readUint16();if(!e.hasOwnProperty(n)){throw new Error("Unsupported format in WAV file")}var i={formatId:n,floatingPoint:n===3,numberOfChannels:t.readUint16(),sampleRate:t.readUint32(),byteRate:t.readUint32(),blockSize:t.readUint16(),bitDepth:t.readUint16()};t.skip(r-16);return i};self.decodeData=function(e,t,r){var n=Math.floor(t/r.blockSize);var i=new Array(r.numberOfChannels);for(var f=0;f<r.numberOfChannels;f++){i[f]=new Float32Array(n)}e.readPCM(i,n,r);var o=i.map(function(e){return e.buffer});return{numberOfChannels:r.numberOfChannels,length:n,sampleRate:r.sampleRate,buffers:o}};function t(e){if(e instanceof ArrayBuffer){this.view=new DataView(e)}else{this.view=new n(e)}this.length=this.view.byteLength;this.pos=0}t.prototype.skip=function(e){for(var t=0;t<e;t++){this.view.getUint8(this.pos++)}};t.prototype.readUint8=function(){var e=this.view.getUint8(this.pos);this.pos+=1;return e};t.prototype.readInt16=function(){var e=this.view.getInt16(this.pos,true);this.pos+=2;return e};t.prototype.readUint16=function(){var e=this.view.getUint16(this.pos,true);this.pos+=2;return e};t.prototype.readUint32=function(){var e=this.view.getUint32(this.pos,true);this.pos+=4;return e};t.prototype.readString=function(e){var t="";for(var r=0;r<e;r++){t+=String.fromCharCode(this.readUint8())}return t};t.prototype.readPCM8=function(){var e=(this.view.getUint8(this.pos)-128)/128;this.pos+=1;return e};t.prototype.readPCM16=function(){var e=this.view.getInt16(this.pos,true)/32768;this.pos+=2;return e};t.prototype.readPCM24=function(){var e=this.view.getUint8(this.pos+0);var t=this.view.getUint8(this.pos+1);var r=this.view.getUint8(this.pos+2);var n=e+(t<<8)+(r<<16);var i=(n&8388608?n-16777216:n)/8388608;this.pos+=3;return i};t.prototype.readPCM32=function(){var e=this.view.getInt32(this.pos,true)/2147483648;this.pos+=4;return e};t.prototype.readPCM32F=function(){var e=this.view.getFloat32(this.pos,true);this.pos+=4;return e};t.prototype.readPCM64F=function(){var e=this.view.getFloat64(this.pos,true);this.pos+=8;return e};t.prototype.readPCM=function(e,t,r){var n=r.numberOfChannels;var i="readPCM"+r.bitDepth;if(r.floatingPoint){i+="F"}if(!this[i]){throw new Error("not suppoerted bit depth "+r.bitDepth)}for(var f=0;f<t;f++){for(var o=0;o<n;o++){e[o][f]=this[i]()}}}}i.self=i.util=self;t.exports=i},{dataview2:4}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("./Decoder");var f=n(i);r["default"]=f["default"];t.exports=r["default"]},{"./Decoder":1}],4:[function(e,t,r){(function(r){var n=e("buffer-dataview");function i(e){if(r.Buffer&&e instanceof r.Buffer){return new n(e)}return new DataView(e)}function f(e){if(r.Buffer){return new r.Buffer(e)}return new Uint8Array(e).buffer}t.exports={DataView2:i,Buffer2:f}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"buffer-dataview":5}],5:[function(e,t,r){t.exports=n;function n(e,t,r){if(!(this instanceof n))throw new TypeError("Constructor DataView requires 'new'");if(!e||null==e.length)throw new TypeError("First argument to DataView constructor must be a Buffer");if(null==t)t=0;if(null==r)r=e.length;this.buffer=e;this.byteOffset=t|0;this.byteLength=r|0}n.prototype.getInt8=function(e){if(arguments.length<1)throw new TypeError("invalid_argument");var t=this.byteOffset+(e|0);var r=this.byteOffset+this.byteLength-1;if(t<this.byteOffset||t>r){throw new RangeError("Offset is outside the bounds of the DataView")}return this.buffer.readInt8(t)};n.prototype.getUint8=function(e){if(arguments.length<1)throw new TypeError("invalid_argument");var t=this.byteOffset+(e|0);var r=this.byteOffset+this.byteLength-1;if(t<this.byteOffset||t>r){throw new RangeError("Offset is outside the bounds of the DataView")}return this.buffer.readUInt8(t)};n.prototype.getInt16=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readInt16LE(r)}else{return this.buffer.readInt16BE(r)}};n.prototype.getUint16=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readUInt16LE(r)}else{return this.buffer.readUInt16BE(r)}};n.prototype.getInt32=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readInt32LE(r)}else{return this.buffer.readInt32BE(r)}};n.prototype.getUint32=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readUInt32LE(r)}else{return this.buffer.readUInt32BE(r)}};n.prototype.getFloat32=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readFloatLE(r)}else{return this.buffer.readFloatBE(r)}};n.prototype.getFloat64=function(e,t){if(arguments.length<1)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}if(t){return this.buffer.readDoubleLE(r)}else{return this.buffer.readDoubleBE(r)}};n.prototype.setInt8=function(e,t){if(arguments.length<2)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}t=(t+128&255)-128;this.buffer.writeInt8(t,r)};n.prototype.setUint8=function(e,t){if(arguments.length<2)throw new TypeError("invalid_argument");var r=this.byteOffset+(e|0);var n=this.byteOffset+this.byteLength-1;if(r<this.byteOffset||r>n){throw new RangeError("Offset is outside the bounds of the DataView")}t=t&255;this.buffer.writeUInt8(t,r)};n.prototype.setInt16=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}t=(t+32768&65535)-32768;if(r){this.buffer.writeInt16LE(t,n)}else{this.buffer.writeInt16BE(t,n)}};n.prototype.setUint16=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}t=t&65535;if(r){this.buffer.writeUInt16LE(t,n)}else{this.buffer.writeUInt16BE(t,n)}};n.prototype.setInt32=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}t|=0;if(r){this.buffer.writeInt32LE(t,n)}else{this.buffer.writeInt32BE(t,n)}};n.prototype.setUint32=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}t=t>>>0;if(r){this.buffer.writeUInt32LE(t,n)}else{this.buffer.writeUInt32BE(t,n)}};n.prototype.setFloat32=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}if(r){this.buffer.writeFloatLE(t,n)}else{this.buffer.writeFloatBE(t,n)}};n.prototype.setFloat64=function(e,t,r){if(arguments.length<2)throw new TypeError("invalid_argument");var n=this.byteOffset+(e|0);var i=this.byteOffset+this.byteLength-1;if(n<this.byteOffset||n>i){throw new RangeError("Offset is outside the bounds of the DataView")}if(r){this.buffer.writeDoubleLE(t,n)}else{this.buffer.writeDoubleBE(t,n)}}},{}],6:[function(e,t,r){"use strict";t.exports=e("./inline-worker")},{"./inline-worker":7}],7:[function(e,t,r){(function(e){"use strict";var r=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var n=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var i=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);var f=function(){function t(r,self){var f=this;n(this,t);if(i){var o=r.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var s=e.URL.createObjectURL(new e.Blob([o],{type:"text/javascript"}));return new e.Worker(s)}this.self=self;this.self.postMessage=function(e){setTimeout(function(){f.onmessage({data:e})},0)};setTimeout(function(){r.call(self)},0)}r(t,{postMessage:{value:function f(e){var t=this;setTimeout(function(){t.self.onmessage({data:e})},0)}}});return t}();t.exports=f}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[3])(3)});
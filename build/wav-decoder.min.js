(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var r;if(typeof window!=="undefined"){r=window}else if(typeof global!=="undefined"){r=global}else if(typeof self!=="undefined"){r=self}else{r=this}r.WavDecoder=e()}})(function(){var e,r,t;return function n(e,r,t){function a(o,f){if(!r[o]){if(!e[o]){var s=typeof require=="function"&&require;if(!f&&s)return s(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(r){var t=e[o][1][r];return a(t?t:r)},c,c.exports,n,e,r,t)}return r[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<t.length;o++)a(t[o]);return a}({1:[function(e,r,t){"use strict";var self={};function n(){self.onmessage=function(e){switch(e.data.type){case"decode":self.decode(e.data.buffer).then(function(e){self.postMessage({type:"decoded",audioData:e},[e.buffers])})["catch"](function(e){self.postMessage({type:"error",message:e.message})});break}};var e={1:"lpcm",3:"lpcm"};self.decode=function(e){return new Promise(function(t){var n=new r(e);if(n.readString(4)!=="RIFF"){throw new Error("Invalid WAV file")}n.readUint32();if(n.readString(4)!=="WAVE"){throw new Error("Invalid WAV file")}var a=null;var i=null;do{var o=n.readString(4);var f=n.readUint32();switch(o){case"fmt ":a=self.decodeFormat(n,f);break;case"data":i=self.decodeData(n,f,a);break;default:n.skip(f);break}}while(i===null);return t(i)})};self.decodeFormat=function(r,t){var n=r.readUint16();if(!e.hasOwnProperty(n)){throw new Error("Unsupported format in WAV file")}var a={formatId:n,floatingPoint:n===3,numberOfChannels:r.readUint16(),sampleRate:r.readUint32(),byteRate:r.readUint32(),blockSize:r.readUint16(),bitsPerSample:r.readUint16()};r.skip(t-16);return a};self.decodeData=function(e,r,t){var n=Math.floor(r/t.blockSize);var a=new Array(t.numberOfChannels);for(var i=0;i<t.numberOfChannels;i++){a[i]=new Float32Array(n)}e.readPCM(a,n,t);var o=a.map(function(e){return e.buffer});return{numberOfChannels:t.numberOfChannels,length:n,sampleRate:t.sampleRate,buffers:o}};function r(e){this.buffer=e;this.view=new DataView(e);this.length=e.byteLength;this.pos=0}r.prototype.skip=function(e){for(var r=0;r<e;r++){this.view.getUint8(this.pos++)}};r.prototype.readUint8=function(){var e=this.view.getUint8(this.pos);this.pos+=1;return e};r.prototype.readInt16=function(){var e=this.view.getInt16(this.pos,true);this.pos+=2;return e};r.prototype.readUint16=function(){var e=this.view.getUint16(this.pos,true);this.pos+=2;return e};r.prototype.readUint32=function(){var e=this.view.getUint32(this.pos,true);this.pos+=4;return e};r.prototype.readString=function(e){var r="";for(var t=0;t<e;t++){r+=String.fromCharCode(this.readUint8())}return r};r.prototype.readPCM=function(e,r,n){var a=n.numberOfChannels;var i=new Uint8Array(this.view.buffer,this.pos);var o=r*a;var f=n.bitsPerSample>>3;var s=Math.ceil(i.byteOffset/f)*f;var u,c=1;if(n.floatingPoint){switch(n.bitsPerSample){case 32:u=new Float32Array(i.buffer,s,o);break;case 64:u=new Float64Array(i.buffer,s,o);break}}else{switch(n.bitsPerSample){case 8:u=new Int8Array(i.buffer,s,o);c=128;break;case 16:u=new Int16Array(i.buffer,s,o);c=32768;break;case 24:u=t(i,i.byteOffset,o*3);c=8388608;break;case 32:u=new Int32Array(i.buffer,s,o);c=2147483648;break}}if(!u){throw new Error("not suppoerted bit depth "+n.bitsPerSample)}for(var d=0;d<r;d++){for(var l=0;l<a;l++){e[l][d]=u[d*a+l]/c}}this.pos+=r};function t(e,r,t){var n=new Uint8Array(e.buffer,r,t);var a=new Int32Array(n.length/3);for(var i=0,o=a.length;i<o;i++){var f=n[i*3+0];var s=n[i*3+1];var u=n[i*3+2];var c=f+(s<<8)+(u<<16);a[i]=c&8388608?c-16777216:c}return a}}n.self=n.util=self;r.exports=n},{}],2:[function(e,r,t){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(){function e(e,r){for(var t in r){var n=r[t];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,r)}return function(r,t,n){if(t)e(r.prototype,t);if(n)e(r,n);return r}}();var i=function(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}};var o=n(e("inline-worker"));var f=n(e("./decoder-worker"));var s=function(){function e(){i(this,e)}a(e,{decode:{value:function r(e){return new Promise(function(r,t){var n=new o(f,f.self);n.onmessage=function(e){if(e.data.type==="decoded"){var n=e.data.audioData;n.channelData=n.buffers.map(function(e){return new Float32Array(e)});return r(n)}return t(new Error(e.data.message))};if(e&&typeof e.length==="number"){e=new Uint8Array(e).buffer}n.postMessage({type:"decode",buffer:e},[e])})}}});return e}();r.exports=s},{"./decoder-worker":1,"inline-worker":4}],3:[function(e,r,t){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=n(e("./decoder"));r.exports=a},{"./decoder":2}],4:[function(e,r,t){"use strict";r.exports=e("./inline-worker")},{"./inline-worker":5}],5:[function(e,r,t){(function(e){"use strict";var t=function(){function e(e,r){for(var t in r){var n=r[t];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,r)}return function(r,t,n){if(t)e(r.prototype,t);if(n)e(r,n);return r}}();var n=function(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}};var a=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);var i=function(){function r(t,self){var i=this;n(this,r);if(a){var o=t.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var f=e.URL.createObjectURL(new e.Blob([o],{type:"text/javascript"}));return new e.Worker(f)}this.self=self;this.self.postMessage=function(e){setTimeout(function(){i.onmessage({data:e})},0)};setTimeout(function(){t.call(self)},0)}t(r,{postMessage:{value:function i(e){var r=this;setTimeout(function(){r.self.onmessage({data:e})},0)}}});return r}();r.exports=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[3])(3)});
(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.WavDecoder=e()}})(function(){var e,t,r;return function n(e,t,r){function i(a,s){if(!t[a]){if(!e[a]){var f=typeof require=="function"&&require;if(!s&&f)return f(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return i(r?r:t)},c,c.exports,n,e,t,r)}return t[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,r){"use strict";var self={};function n(){self.onmessage=function(e){switch(e.data.type){case"decode":self.decode(e.data.buffer).then(function(t){var r={type:"decoded",callbackId:e.data.callbackId,audioData:t};self.postMessage(r,[t.buffers])},function(t){var r={type:"error",callbackId:e.data.callbackId,message:t.message};self.postMessage(r)});break}};var e={1:"lpcm",3:"lpcm"};self.decode=function(e){return new Promise(function(r){var n=new t(e);if(n.readString(4)!=="RIFF"){throw new Error("Invalid WAV file")}n.readUint32();if(n.readString(4)!=="WAVE"){throw new Error("Invalid WAV file")}var i=null;var o=null;do{var a=n.readString(4);var s=n.readUint32();switch(a){case"fmt ":i=self.decodeFormat(n,s);break;case"data":o=self.decodeData(n,s,i);break;default:n.skip(s);break}}while(o===null);return r(o)})};self.decodeFormat=function(t,r){var n=t.readUint16();if(!e.hasOwnProperty(n)){throw new Error("Unsupported format in WAV file")}var i={formatId:n,floatingPoint:n===3,numberOfChannels:t.readUint16(),sampleRate:t.readUint32(),byteRate:t.readUint32(),blockSize:t.readUint16(),bitDepth:t.readUint16()};t.skip(r-16);return i};self.decodeData=function(e,t,r){var n=Math.floor(t/r.blockSize);var i=new Array(r.numberOfChannels);for(var o=0;o<r.numberOfChannels;o++){i[o]=new Float32Array(n)}e.readPCM(i,n,r);var a=i.map(function(e){return e.buffer});return{numberOfChannels:r.numberOfChannels,length:n,sampleRate:r.sampleRate,buffers:a}};function t(e){this.buffer=e;this.view=new DataView(e);this.length=e.byteLength;this.pos=0}t.prototype.skip=function(e){for(var t=0;t<e;t++){this.view.getUint8(this.pos++)}};t.prototype.readUint8=function(){var e=this.view.getUint8(this.pos);this.pos+=1;return e};t.prototype.readInt16=function(){var e=this.view.getInt16(this.pos,true);this.pos+=2;return e};t.prototype.readUint16=function(){var e=this.view.getUint16(this.pos,true);this.pos+=2;return e};t.prototype.readUint32=function(){var e=this.view.getUint32(this.pos,true);this.pos+=4;return e};t.prototype.readString=function(e){var t="";for(var r=0;r<e;r++){t+=String.fromCharCode(this.readUint8())}return t};t.prototype.readPCM8=function(){var e=(this.view.getUint8(this.pos)-128)/128;this.pos+=1;return e};t.prototype.readPCM16=function(){var e=this.view.getInt16(this.pos,true)/32768;this.pos+=2;return e};t.prototype.readPCM24=function(){var e=this.view.getUint8(this.pos+0);var t=this.view.getUint8(this.pos+1);var r=this.view.getUint8(this.pos+2);var n=e+(t<<8)+(r<<16);var i=(n&8388608?n-16777216:n)/8388608;this.pos+=3;return i};t.prototype.readPCM32=function(){var e=this.view.getInt32(this.pos,true)/2147483648;this.pos+=4;return e};t.prototype.readPCM32F=function(){var e=this.view.getFloat32(this.pos,true);this.pos+=4;return e};t.prototype.readPCM64F=function(){var e=this.view.getFloat64(this.pos,true);this.pos+=8;return e};t.prototype.readPCM=function(e,t,r){var n=r.numberOfChannels;var i="readPCM"+r.bitDepth;if(r.floatingPoint){i+="F"}if(!this[i]){throw new Error("not suppoerted bit depth "+r.bitDepth)}for(var o=0;o<t;o++){for(var a=0;a<n;a++){e[a][o]=this[i]()}}}}n.self=n.util=self;t.exports=n},{}],2:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var a=n(e("inline-worker"));var s=n(e("./decoder-worker"));var f=function(){function e(){var t=this;o(this,e);this._worker=new a(s,s.self);this._worker.onmessage=function(e){var r=t._callbacks[e.data.callbackId];if(r){if(e.data.type==="decoded"){var n=e.data.audioData;n.channelData=n.buffers.map(function(e){return new Float32Array(e)});r.resolve(n)}else{r.reject(new Error(e.data.message))}}t._callbacks[e.data.callbackId]=null};this._callbacks=[]}i(e,{decode:{value:function t(e){var t=this;return new Promise(function(r,n){var i=t._callbacks.length;t._callbacks.push({resolve:r,reject:n});if(e&&typeof e.length==="number"){e=new Uint8Array(e).buffer}t._worker.postMessage({type:"decode",buffer:e,callbackId:i},[e])})}}});return e}();t.exports=f},{"./decoder-worker":1,"inline-worker":4}],3:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var i=n(e("./decoder"));t.exports=i},{"./decoder":2}],4:[function(e,t,r){"use strict";t.exports=e("./inline-worker")},{"./inline-worker":5}],5:[function(e,t,r){(function(e){"use strict";var r=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var n=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var i=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);var o=function(){function t(r,self){var o=this;n(this,t);if(i){var a=r.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var s=e.URL.createObjectURL(new e.Blob([a],{type:"text/javascript"}));return new e.Worker(s)}this.self=self;this.self.postMessage=function(e){setTimeout(function(){o.onmessage({data:e})},0)};setTimeout(function(){r.call(self)},0)}r(t,{postMessage:{value:function o(e){var t=this;setTimeout(function(){t.self.onmessage({data:e})},0)}}});return t}();t.exports=o}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[3])(3)});